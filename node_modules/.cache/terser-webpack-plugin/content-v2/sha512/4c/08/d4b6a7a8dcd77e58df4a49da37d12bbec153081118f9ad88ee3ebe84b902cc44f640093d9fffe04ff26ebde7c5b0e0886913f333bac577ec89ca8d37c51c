{"code":"!function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\",a(a.s=0)}([function(e,t,a){a(1),e.exports=a(2)},function(e,t,a){function n(e,t,a,n){return Math.pow(e-a,2)+Math.pow(t-n,2)}function o(e,t,a){let o=0;minDist=n(a[0].x,a[0].y,e,t);for(let r=1;r<a.length;r++)dist=n(a[r].x,a[r].y,e,t),dist<minDist&&(o=r,minDist=dist);return o}function r(e){const t=e.max/10;for(var a=e,n=a.data.length;n--;)a.data[n]<t&&a.data.splice(n,1);return a}t.findBestLocation=function(e,t){t=r(t);var a=0,n=[],l=[];for(let a=0;a<e;a++){let e=Math.floor(Math.random()*t.data.length);n.push({x:t.data[e].lat,y:t.data[e].lng})}for(console.log(\"after init centroids\"),console.log(n);;){let e=[],r=[],g=[],d=[],c=[];for(let a=0;a<t.data.length;a++){e[a]=o(t.data[a].lat,t.data[a].lng,n),null==r[e[a]]&&(r[e[a]]=0,g[e[a]]=0,c[e[a]]=0,d[e[a]]=0);let l=Math.pow(t.data[a].count/t.max,3);d[e[a]]+=l,r[e[a]]+=t.data[a].lat*l,g[e[a]]+=t.data[a].lng*l,c[e[a]]++}for(let e=0;e<n.length;e++)n[e].x=1/d[e]*r[e],n[e].y=1/d[e]*g[e];if(JSON.stringify(l)==JSON.stringify(e)){console.log(\"finish normally\"),console.log(n);break}if(a++>50){console.log(\"max reached\"),console.log(n);break}l=e}return n},t.getDistance=n,t.getClosestPointIndex=o,t.pruneDataSet=r},function(e,t){var a=new google.maps.Geocoder;function n(e,t,a){var n={lat:t,lng:a};e.geocode({location:n},(function(e,t){\"OK\"===t?e[1]?document.getElementById(\"address\").value=e[0].formatted_address:document.getElementById(\"address\").value=\"No results found\":document.getElementById(\"address\").value=\"Geocoder failed due to: \"+t}))}var o=L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",{attribution:'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imagery Â© <a href=\"http://cloudmade.com\">CloudMade</a>',maxZoom:18}),r=new L.Map(document.getElementById(\"map\"),{center:new L.LatLng(42.3736,-71.1097),zoom:13,layers:[o]});r.on(\"click\",(function(e){for(var t in(y=new L.marker(e.latlng,{draggable:\"true\"})).on(\"click\",l),markercontainer.push(y),AllScores)document.getElementById(t).value=c(y.getLatLng().lat,y.getLatLng().lng,AllScores[t]);n(a,y.getLatLng().lat,y.getLatLng().lng);y.addTo(r),r.panTo(y.getLatLng()),y.on(\"dragend\",(function(e){var t=e.target,o=t.getLatLng();t.setLatLng(new L.LatLng(o.lat,o.lng),{draggable:\"true\"});n(a,t.getLatLng().lat,t.getLatLng().lng);for(var l in t.addTo(r),AllScores)document.getElementById(l).value=c(t.getLatLng().lat,t.getLatLng().lng,AllScores[l]);n(a,t.getLatLng().lat,t.getLatLng().lng);r.panTo(new L.LatLng(o.lat,o.lng))})),r.addLayer(y)}));function l(e){for(var t in AllScores)document.getElementById(t).value=c(e.latlng.lat,e.latlng.lng,AllScores[t]);n(a,e.latlng.lat,e.latlng.lng);r.panTo(new L.LatLng(e.latlng.lat,e.latlng.lng))}var g=new HeatmapOverlay({radius:.007,maxOpacity:.8,scaleRadius:!0,useLocalExtrema:!0,latField:\"lat\",lngField:\"lng\",valueField:\"count\",blur:.8});g.setData({max:0,data:[]});var d=L.layerGroup([g]);function c(e,t,a){return score=function(e,t,a){var n=a[0].lat,o=a[0].lng,r=Math.pow(Math.abs(e-n),2)+Math.pow(Math.abs(t-o),2),l=0;for(i=1;i<a.length;i++)currlat=a[i].lat,currlng=a[i].lng,currdist=Math.pow(Math.abs(e-currlat),2)+Math.pow(Math.abs(t-currlng),2),currdist<r&&(n=currlat,o=currlng,l=i,r=currdist);return a[l].count}(e,t,a.data),Math.round(1e3*score/a.max)/100}r.addLayer(d),document.getElementById(\"selectcity\").onchange=function(){var e=document.createElement(\"script\");e.setAttribute(\"src\",\"DataFiles/SoofaData\"+this.value.split(\" \")[0]+\".js\"),document.head.appendChild(e),e.onload=function(){g.setData({max:0,data:[]}),document.getElementById(\"layerselector\").reset(),r.panTo(new L.LatLng(lat,lng));for(var e=0;e<markercontainer.length;e++)r.removeLayer(markercontainer[e]);for(var t in markercontainer=[],layersactive=[],r.removeLayer(f),f=L.rectangle([northeastcoord,southwestcoord],{dashArray:\"10\",color:\"#4d4d4d\",opacity:.8,fillOpacity:0}),r.addLayer(f),AllScores)document.getElementById(t).value=\"\";document.getElementById(\"address\").value=\"\"}};var s=new google.maps.places.SearchBox(document.getElementById(\"mapsearch\"));google.maps.event.addListener(s,\"places_changed\",(function(){for(var e=0;e<s.getPlaces().length;e++){for(var t in(y=new L.marker([s.getPlaces()[e].geometry.location.lat(),s.getPlaces()[e].geometry.location.lng()],{draggable:\"true\"})).on(\"click\",l),markercontainer.push(y),AllScores)document.getElementById(t).value=c(y.getLatLng().lat,y.getLatLng().lng,AllScores[t]);n(a,y.getLatLng().lat,y.getLatLng().lng);y.addTo(r),r.panTo(y.getLatLng()),y.on(\"dragend\",(function(e){var t=e.target,o=t.getLatLng();t.setLatLng(new L.LatLng(o.lat,o.lng),{draggable:\"true\"});n(a,t.getLatLng().lat,t.getLatLng().lng);for(var l in t.addTo(r),AllScores)document.getElementById(l).value=c(t.getLatLng().lat,t.getLatLng().lng,AllScores[l]);document.getElementById(\"address\").value=s.getPlaces()[0].address,r.panTo(new L.LatLng(o.lat,o.lng))})),r.addLayer(y)}}));var u=document.getElementById(\"scorebutton\"),m=!1;u.onclick=function(){m?(document.getElementById(\"scoresform\").style.visibility=\"hidden\",m=!m):(document.getElementById(\"scoresform\").style.visibility=\"visible\",m=!m)};var f=L.rectangle([northeastcoord,southwestcoord],{dashArray:\"10\",color:\"#4d4d4d\",opacity:.8,fillOpacity:0});r.addLayer(f),centroids=findBestLocation(5,googlefoodData),console.log(centroids);for(let e of centroids){var y=new L.marker([e.x,e.y],{draggable:\"true\"}).addTo(r);y.on(\"click\",l)}}]);","extractedComments":[]}